{"ast":null,"code":"import React,{useState,useEffect,useContext}from'react';import{UserContext}from'../../App';import{Link}from'react-router-dom';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const Home=()=>{const[data,setData]=useState([]);const{state,dispatch}=useContext(UserContext);useEffect(()=>{fetch('/getsubpost',{headers:{\"Authorization\":\"Bearer \"+localStorage.getItem(\"jwt\")}}).then(res=>res.json()).then(result=>{console.log(result);setData(result.posts);});},[]);const likePost=id=>{fetch('/like',{method:\"put\",headers:{\"Content-Type\":\"application/json\",\"Authorization\":\"Bearer \"+localStorage.getItem(\"jwt\")},body:JSON.stringify({postId:id})}).then(res=>res.json()).then(result=>{//   console.log(result)\nconst newData=data.map(item=>{if(item._id==result._id){return result;}else{return item;}});setData(newData);}).catch(err=>{console.log(err);});};const unlikePost=id=>{fetch('/unlike',{method:\"put\",headers:{\"Content-Type\":\"application/json\",\"Authorization\":\"Bearer \"+localStorage.getItem(\"jwt\")},body:JSON.stringify({postId:id})}).then(res=>res.json()).then(result=>{//   console.log(result)\nconst newData=data.map(item=>{if(item._id==result._id){return result;}else{return item;}});setData(newData);}).catch(err=>{console.log(err);});};const makeComment=(text,postId)=>{fetch('/comment',{method:\"put\",headers:{\"Content-Type\":\"application/json\",\"Authorization\":\"Bearer \"+localStorage.getItem(\"jwt\")},body:JSON.stringify({postId,text})}).then(res=>res.json()).then(result=>{console.log(result);const newData=data.map(item=>{if(item._id==result._id){return result;}else{return item;}});setData(newData);}).catch(err=>{console.log(err);});};const deletePost=postid=>{fetch(`/deletepost/${postid}`,{method:\"delete\",headers:{Authorization:\"Bearer \"+localStorage.getItem(\"jwt\")}}).then(res=>res.json()).then(result=>{console.log(result);const newData=data.filter(item=>{return item._id!==result._id;});setData(newData);});};return/*#__PURE__*/_jsx(\"div\",{className:\"home\",children:data.map(item=>{return/*#__PURE__*/_jsxs(\"div\",{className:\"card home-card\",children:[/*#__PURE__*/_jsxs(\"h5\",{style:{padding:\"5px\"},children:[/*#__PURE__*/_jsx(Link,{to:item.postedBy._id!==state._id?\"/profile/\"+item.postedBy._id:\"/profile\",children:item.postedBy.name}),\" \",item.postedBy._id==state._id&&/*#__PURE__*/_jsx(\"i\",{className:\"material-icons\",style:{float:\"right\"},onClick:()=>deletePost(item._id),children:\"delete\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"card-image\",children:/*#__PURE__*/_jsx(\"img\",{src:item.photo})}),/*#__PURE__*/_jsxs(\"div\",{className:\"card-content\",children:[/*#__PURE__*/_jsx(\"i\",{className:\"material-icons\",style:{color:\"red\"},children:\"favorite\"}),item.likes.includes(state._id)?/*#__PURE__*/_jsx(\"i\",{className:\"material-icons\",onClick:()=>{unlikePost(item._id);},children:\"thumb_down\"}):/*#__PURE__*/_jsx(\"i\",{className:\"material-icons\",onClick:()=>{likePost(item._id);},children:\"thumb_up\"}),/*#__PURE__*/_jsxs(\"h6\",{children:[item.likes.length,\" likes\"]}),/*#__PURE__*/_jsx(\"h6\",{children:item.title}),/*#__PURE__*/_jsx(\"p\",{children:item.body}),item.comments.map(record=>{return/*#__PURE__*/_jsxs(\"h6\",{children:[/*#__PURE__*/_jsx(\"span\",{style:{fontWeight:\"500\"},children:record.postedBy.name}),\" \",record.text]},record._id);}),/*#__PURE__*/_jsx(\"form\",{onSubmit:e=>{e.preventDefault();makeComment(e.target[0].value,item._id);},children:/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"add a comment\"})})]})]},item._id);})});};export default Home;","map":{"version":3,"names":["React","useState","useEffect","useContext","UserContext","Link","jsx","_jsx","jsxs","_jsxs","Home","data","setData","state","dispatch","fetch","headers","localStorage","getItem","then","res","json","result","console","log","posts","likePost","id","method","body","JSON","stringify","postId","newData","map","item","_id","catch","err","unlikePost","makeComment","text","deletePost","postid","Authorization","filter","className","children","style","padding","to","postedBy","name","float","onClick","src","photo","color","likes","includes","length","title","comments","record","fontWeight","onSubmit","e","preventDefault","target","value","type","placeholder"],"sources":["C:/Users/kovia/Desktop/clone insta 2/insta-clone/client/src/components/screens/SubscribesUserPosts.js"],"sourcesContent":["import React,{useState,useEffect,useContext} from 'react'\r\nimport {UserContext} from '../../App'\r\nimport {Link} from 'react-router-dom'\r\nconst Home  = ()=>{\r\n    const [data,setData] = useState([])\r\n    const {state,dispatch} = useContext(UserContext)\r\n    useEffect(()=>{\r\n       fetch('/getsubpost',{\r\n           headers:{\r\n               \"Authorization\":\"Bearer \"+localStorage.getItem(\"jwt\")\r\n           }\r\n       }).then(res=>res.json())\r\n       .then(result=>{\r\n           console.log(result)\r\n           setData(result.posts)\r\n       })\r\n    },[])\r\n\r\n    const likePost = (id)=>{\r\n          fetch('/like',{\r\n              method:\"put\",\r\n              headers:{\r\n                  \"Content-Type\":\"application/json\",\r\n                  \"Authorization\":\"Bearer \"+localStorage.getItem(\"jwt\")\r\n              },\r\n              body:JSON.stringify({\r\n                  postId:id\r\n              })\r\n          }).then(res=>res.json())\r\n          .then(result=>{\r\n                   //   console.log(result)\r\n            const newData = data.map(item=>{\r\n                if(item._id==result._id){\r\n                    return result\r\n                }else{\r\n                    return item\r\n                }\r\n            })\r\n            setData(newData)\r\n          }).catch(err=>{\r\n              console.log(err)\r\n          })\r\n    }\r\n    const unlikePost = (id)=>{\r\n          fetch('/unlike',{\r\n              method:\"put\",\r\n              headers:{\r\n                  \"Content-Type\":\"application/json\",\r\n                  \"Authorization\":\"Bearer \"+localStorage.getItem(\"jwt\")\r\n              },\r\n              body:JSON.stringify({\r\n                  postId:id\r\n              })\r\n          }).then(res=>res.json())\r\n          .then(result=>{\r\n            //   console.log(result)\r\n            const newData = data.map(item=>{\r\n                if(item._id==result._id){\r\n                    return result\r\n                }else{\r\n                    return item\r\n                }\r\n            })\r\n            setData(newData)\r\n          }).catch(err=>{\r\n            console.log(err)\r\n        })\r\n    }\r\n\r\n    const makeComment = (text,postId)=>{\r\n          fetch('/comment',{\r\n              method:\"put\",\r\n              headers:{\r\n                  \"Content-Type\":\"application/json\",\r\n                  \"Authorization\":\"Bearer \"+localStorage.getItem(\"jwt\")\r\n              },\r\n              body:JSON.stringify({\r\n                  postId,\r\n                  text\r\n              })\r\n          }).then(res=>res.json())\r\n          .then(result=>{\r\n              console.log(result)\r\n              const newData = data.map(item=>{\r\n                if(item._id==result._id){\r\n                    return result\r\n                }else{\r\n                    return item\r\n                }\r\n             })\r\n            setData(newData)\r\n          }).catch(err=>{\r\n              console.log(err)\r\n          })\r\n    }\r\n\r\n    const deletePost = (postid)=>{\r\n        fetch(`/deletepost/${postid}`,{\r\n            method:\"delete\",\r\n            headers:{\r\n                Authorization:\"Bearer \"+localStorage.getItem(\"jwt\")\r\n            }\r\n        }).then(res=>res.json())\r\n        .then(result=>{\r\n            console.log(result)\r\n            const newData = data.filter(item=>{\r\n                return item._id !== result._id\r\n            })\r\n            setData(newData)\r\n        })\r\n    }\r\n   return (\r\n       <div className=\"home\">\r\n           {\r\n               data.map(item=>{\r\n                   return(\r\n                       <div className=\"card home-card\" key={item._id}>\r\n                            <h5 style={{padding:\"5px\"}}><Link to={item.postedBy._id !== state._id?\"/profile/\"+item.postedBy._id :\"/profile\"  }>{item.postedBy.name}</Link> {item.postedBy._id == state._id \r\n                            && <i className=\"material-icons\" style={{\r\n                                float:\"right\"\r\n                            }} \r\n                            onClick={()=>deletePost(item._id)}\r\n                            >delete</i>\r\n\r\n                            }</h5>\r\n                            <div className=\"card-image\">\r\n                                <img src={item.photo}/>\r\n                            </div>\r\n                            <div className=\"card-content\">\r\n                            <i className=\"material-icons\" style={{color:\"red\"}}>favorite</i>\r\n                            {item.likes.includes(state._id)\r\n                            ? \r\n                             <i className=\"material-icons\"\r\n                                    onClick={()=>{unlikePost(item._id)}}\r\n                              >thumb_down</i>\r\n                            : \r\n                            <i className=\"material-icons\"\r\n                            onClick={()=>{likePost(item._id)}}\r\n                            >thumb_up</i>\r\n                            }\r\n                            \r\n                           \r\n                                <h6>{item.likes.length} likes</h6>\r\n                                <h6>{item.title}</h6>\r\n                                <p>{item.body}</p>\r\n                                {\r\n                                    item.comments.map(record=>{\r\n                                        return(\r\n                                        <h6 key={record._id}><span style={{fontWeight:\"500\"}}>{record.postedBy.name}</span> {record.text}</h6>\r\n                                        )\r\n                                    })\r\n                                }\r\n                                <form onSubmit={(e)=>{\r\n                                    e.preventDefault()\r\n                                    makeComment(e.target[0].value,item._id)\r\n                                }}>\r\n                                  <input type=\"text\" placeholder=\"add a comment\" />  \r\n                                </form>\r\n                                \r\n                            </div>\r\n                        </div> \r\n                   )\r\n               })\r\n           }\r\n          \r\n          \r\n       </div>\r\n   )\r\n}\r\n\r\n\r\nexport default Home"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}