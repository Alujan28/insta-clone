{"ast":null,"code":"import React,{useState,useEffect}from'react';import M from'materialize-css';import{useNavigate}from'react-router-dom';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const CreatePost=()=>{const navigate=useNavigate();const[title,setTitle]=useState('');const[body,setBody]=useState('');const[image,setImage]=useState(null);const[url,setUrl]=useState('');useEffect(()=>{if(url){fetch('/createpost',{method:'post',headers:{'Content-Type':'application/json',Authorization:'Bearer '+localStorage.getItem('jwt')},body:JSON.stringify({title,body,pic:url})}).then(res=>res.json()).then(data=>{if(data.error){M.toast({html:data.error,classes:'#c62828 red darken-3'});}else{M.toast({html:'Created post successfully',classes:'#43a047 green darken-1'});navigate('/');}}).catch(err=>{console.error('Error creating post:',err);M.toast({html:'Failed to create post. Please try again.',classes:'#c62828 red darken-3'});});}},[url,navigate,title,body]);const postDetails=()=>{if(!image){M.toast({html:'Please upload an image.',classes:'#c62828 red darken-3'});return;}const data=new FormData();data.append('file',image);data.append('upload_preset','new-insta');data.append('cloud_name','cnq');fetch('https://api.cloudinary.com/v1_1/dqkmnrjdr/image/upload',{method:'post',body:data}).then(res=>res.json()).then(data=>{if(data.url){setUrl(data.url);}else{throw new Error('Failed to upload image.');}}).catch(err=>{console.error('Error uploading image:',err);M.toast({html:'Image upload failed. Please try again.',classes:'#c62828 red darken-3'});});};return/*#__PURE__*/_jsxs(\"div\",{className:\"card input-field\",style:{margin:'30px auto',maxWidth:'500px',padding:'20px',textAlign:'center'},children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Title\",value:title,onChange:e=>setTitle(e.target.value)}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Body\",value:body,onChange:e=>setBody(e.target.value)}),/*#__PURE__*/_jsxs(\"div\",{className:\"file-field input-field\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"btn #64b5f6 blue darken-1\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"Upload Image\"}),/*#__PURE__*/_jsx(\"input\",{type:\"file\",onChange:e=>setImage(e.target.files[0])})]}),/*#__PURE__*/_jsx(\"div\",{className:\"file-path-wrapper\",children:/*#__PURE__*/_jsx(\"input\",{className:\"file-path validate\",type:\"text\"})})]}),/*#__PURE__*/_jsx(\"button\",{className:\"btn waves-effect waves-light #64b5f6 blue darken-1\",onClick:postDetails,children:\"Submit Post\"})]});};export default CreatePost;","map":{"version":3,"names":["React","useState","useEffect","M","useNavigate","jsx","_jsx","jsxs","_jsxs","CreatePost","navigate","title","setTitle","body","setBody","image","setImage","url","setUrl","fetch","method","headers","Authorization","localStorage","getItem","JSON","stringify","pic","then","res","json","data","error","toast","html","classes","catch","err","console","postDetails","FormData","append","Error","className","style","margin","maxWidth","padding","textAlign","children","type","placeholder","value","onChange","e","target","files","onClick"],"sources":["C:/Users/kovia/Desktop/clone insta 2/insta-clone/client/src/components/screens/CreatePost.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport M from 'materialize-css';\r\nimport { useNavigate } from 'react-router-dom';\r\n\r\nconst CreatePost = () => {\r\n    const navigate = useNavigate();\r\n    const [title, setTitle] = useState('');\r\n    const [body, setBody] = useState('');\r\n    const [image, setImage] = useState(null);\r\n    const [url, setUrl] = useState('');\r\n\r\n    useEffect(() => {\r\n        if (url) {\r\n            fetch('/createpost', {\r\n                method: 'post',\r\n                headers: {\r\n                    'Content-Type': 'application/json',\r\n                    Authorization: 'Bearer ' + localStorage.getItem('jwt'),\r\n                },\r\n                body: JSON.stringify({\r\n                    title,\r\n                    body,\r\n                    pic: url,\r\n                }),\r\n            })\r\n                .then((res) => res.json())\r\n                .then((data) => {\r\n                    if (data.error) {\r\n                        M.toast({\r\n                            html: data.error,\r\n                            classes: '#c62828 red darken-3',\r\n                        });\r\n                    } else {\r\n                        M.toast({\r\n                            html: 'Created post successfully',\r\n                            classes: '#43a047 green darken-1',\r\n                        });\r\n                        navigate('/');\r\n                    }\r\n                })\r\n                .catch((err) => {\r\n                    console.error('Error creating post:', err);\r\n                    M.toast({\r\n                        html: 'Failed to create post. Please try again.',\r\n                        classes: '#c62828 red darken-3',\r\n                    });\r\n                });\r\n        }\r\n    }, [url, navigate, title, body]);\r\n\r\n    const postDetails = () => {\r\n        if (!image) {\r\n            M.toast({\r\n                html: 'Please upload an image.',\r\n                classes: '#c62828 red darken-3',\r\n            });\r\n            return;\r\n        }\r\n\r\n        const data = new FormData();\r\n        data.append('file', image);\r\n        data.append('upload_preset', 'new-insta');\r\n        data.append('cloud_name', 'cnq');\r\n\r\n        fetch('https://api.cloudinary.com/v1_1/dqkmnrjdr/image/upload', {\r\n            method: 'post',\r\n            body: data,\r\n        })\r\n            .then((res) => res.json())\r\n            .then((data) => {\r\n                if (data.url) {\r\n                    setUrl(data.url);\r\n                } else {\r\n                    throw new Error('Failed to upload image.');\r\n                }\r\n            })\r\n            .catch((err) => {\r\n                console.error('Error uploading image:', err);\r\n                M.toast({\r\n                    html: 'Image upload failed. Please try again.',\r\n                    classes: '#c62828 red darken-3',\r\n                });\r\n            });\r\n    };\r\n\r\n    return (\r\n        <div\r\n            className=\"card input-field\"\r\n            style={{\r\n                margin: '30px auto',\r\n                maxWidth: '500px',\r\n                padding: '20px',\r\n                textAlign: 'center',\r\n            }}\r\n        >\r\n            <input\r\n                type=\"text\"\r\n                placeholder=\"Title\"\r\n                value={title}\r\n                onChange={(e) => setTitle(e.target.value)}\r\n            />\r\n            <input\r\n                type=\"text\"\r\n                placeholder=\"Body\"\r\n                value={body}\r\n                onChange={(e) => setBody(e.target.value)}\r\n            />\r\n            <div className=\"file-field input-field\">\r\n                <div className=\"btn #64b5f6 blue darken-1\">\r\n                    <span>Upload Image</span>\r\n                    <input\r\n                        type=\"file\"\r\n                        onChange={(e) => setImage(e.target.files[0])}\r\n                    />\r\n                </div>\r\n                <div className=\"file-path-wrapper\">\r\n                    <input className=\"file-path validate\" type=\"text\" />\r\n                </div>\r\n            </div>\r\n            <button\r\n                className=\"btn waves-effect waves-light #64b5f6 blue darken-1\"\r\n                onClick={postDetails}\r\n            >\r\n                Submit Post\r\n            </button>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default CreatePost;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}