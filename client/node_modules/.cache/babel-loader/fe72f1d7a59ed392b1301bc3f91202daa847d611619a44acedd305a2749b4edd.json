{"ast":null,"code":"import React,{useState,useEffect}from'react';import{Link,useNavigate}from'react-router-dom';// Replace useHistory with useNavigate\nimport M from'materialize-css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const SignIn=()=>{const navigate=useNavigate();// useNavigate instead of useHistory\nconst[name,setName]=useState(\"\");const[password,setPassword]=useState(\"\");const[email,setEmail]=useState(\"\");const[image,setImage]=useState(null);// Set initial state to null for image\nconst[url,setUrl]=useState(undefined);useEffect(()=>{if(url){uploadFields();// Call uploadFields once the URL is set\n}},[url]);// Upload image to cloudinary\nconst uploadPic=()=>{const data=new FormData();data.append(\"file\",image);data.append(\"upload_preset\",\"new-insta\");data.append(\"cloud_name\",\"cnq\");fetch(\"https://api.cloudinary.com/v1_1/cnq/image/upload\",{method:\"POST\",body:data}).then(res=>res.json()).then(data=>{setUrl(data.url);// Set the URL after the image is uploaded\n}).catch(err=>{console.log(err);});};// Upload user data once image URL is available\nconst uploadFields=()=>{if(!/^(([^<>()\\[\\]\\\\.,;:\\s@\"]+(\\.[^<>()\\[\\]\\\\.,;:\\s@\"]+)*)|(\".+\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/.test(email)){M.toast({html:\"Invalid email\",classes:\"#c62828 red darken-3\"});return;}fetch(\"/signup\",{method:\"POST\",headers:{\"Content-Type\":\"application/json\"},body:JSON.stringify({name,password,email,pic:url})}).then(res=>res.json()).then(data=>{if(data.error){M.toast({html:data.error,classes:\"#c62828 red darken-3\"});}else{M.toast({html:data.message,classes:\"#43a047 green darken-1\"});navigate('/signin');// Use navigate for redirection\n}}).catch(err=>{console.log(err);});};const PostData=()=>{if(image){uploadPic();// If image is provided, upload it first\n}else{uploadFields();// Otherwise, just upload fields\n}};return/*#__PURE__*/_jsx(\"div\",{className:\"mycard\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"card auth-card input-field\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Instagram\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Name\",value:name,onChange:e=>setName(e.target.value)// Handle name input change\n}),/*#__PURE__*/_jsx(\"input\",{type:\"email\",placeholder:\"Email\",value:email,onChange:e=>setEmail(e.target.value)// Handle email input change\n}),/*#__PURE__*/_jsx(\"input\",{type:\"password\",placeholder:\"Password\",value:password,onChange:e=>setPassword(e.target.value)// Handle password input change\n}),/*#__PURE__*/_jsxs(\"div\",{className:\"file-field input-field\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"btn #64b5f6 blue darken-1\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"Upload pic\"}),/*#__PURE__*/_jsx(\"input\",{type:\"file\",onChange:e=>setImage(e.target.files[0])// Set the image file\n})]}),/*#__PURE__*/_jsx(\"div\",{className:\"file-path-wrapper\",children:/*#__PURE__*/_jsx(\"input\",{className:\"file-path validate\",type:\"text\"})})]}),/*#__PURE__*/_jsx(\"button\",{className:\"btn waves-effect waves-light #64b5f6 blue darken-1\",onClick:PostData// Trigger PostData on button click\n,children:\"SignUp\"}),/*#__PURE__*/_jsx(\"h5\",{children:/*#__PURE__*/_jsx(Link,{to:\"/signin\",children:\"Already have an account?\"})})]})});};export default SignIn;","map":{"version":3,"names":["React","useState","useEffect","Link","useNavigate","M","jsx","_jsx","jsxs","_jsxs","SignIn","navigate","name","setName","password","setPassword","email","setEmail","image","setImage","url","setUrl","undefined","uploadFields","uploadPic","data","FormData","append","fetch","method","body","then","res","json","catch","err","console","log","test","toast","html","classes","headers","JSON","stringify","pic","error","message","PostData","className","children","type","placeholder","value","onChange","e","target","files","onClick","to"],"sources":["C:/Users/kovia/Desktop/clone insta 2/insta-clone/client/src/components/screens/Signup.js"],"sourcesContent":["import React, { useState, useEffect } from 'react'\r\nimport { Link, useNavigate } from 'react-router-dom'  // Replace useHistory with useNavigate\r\nimport M from 'materialize-css'\r\n\r\nconst SignIn = () => {\r\n    const navigate = useNavigate()  // useNavigate instead of useHistory\r\n    const [name, setName] = useState(\"\")\r\n    const [password, setPassword] = useState(\"\")\r\n    const [email, setEmail] = useState(\"\")\r\n    const [image, setImage] = useState(null)  // Set initial state to null for image\r\n    const [url, setUrl] = useState(undefined)\r\n\r\n    useEffect(() => {\r\n        if (url) {\r\n            uploadFields()  // Call uploadFields once the URL is set\r\n        }\r\n    }, [url])\r\n\r\n    // Upload image to cloudinary\r\n    const uploadPic = () => {\r\n        const data = new FormData()\r\n        data.append(\"file\", image)\r\n        data.append(\"upload_preset\", \"new-insta\")\r\n        data.append(\"cloud_name\", \"cnq\")\r\n\r\n        fetch(\"https://api.cloudinary.com/v1_1/cnq/image/upload\", {\r\n            method: \"POST\",\r\n            body: data\r\n        })\r\n            .then(res => res.json())\r\n            .then(data => {\r\n                setUrl(data.url)  // Set the URL after the image is uploaded\r\n            })\r\n            .catch(err => {\r\n                console.log(err)\r\n            })\r\n    }\r\n\r\n    // Upload user data once image URL is available\r\n    const uploadFields = () => {\r\n        if (!/^(([^<>()\\[\\]\\\\.,;:\\s@\"]+(\\.[^<>()\\[\\]\\\\.,;:\\s@\"]+)*)|(\".+\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/.test(email)) {\r\n            M.toast({ html: \"Invalid email\", classes: \"#c62828 red darken-3\" })\r\n            return\r\n        }\r\n\r\n        fetch(\"/signup\", {\r\n            method: \"POST\",\r\n            headers: {\r\n                \"Content-Type\": \"application/json\"\r\n            },\r\n            body: JSON.stringify({\r\n                name,\r\n                password,\r\n                email,\r\n                pic: url\r\n            })\r\n        })\r\n            .then(res => res.json())\r\n            .then(data => {\r\n                if (data.error) {\r\n                    M.toast({ html: data.error, classes: \"#c62828 red darken-3\" })\r\n                } else {\r\n                    M.toast({ html: data.message, classes: \"#43a047 green darken-1\" })\r\n                    navigate('/signin')  // Use navigate for redirection\r\n                }\r\n            })\r\n            .catch(err => {\r\n                console.log(err)\r\n            })\r\n    }\r\n\r\n    const PostData = () => {\r\n        if (image) {\r\n            uploadPic()  // If image is provided, upload it first\r\n        } else {\r\n            uploadFields()  // Otherwise, just upload fields\r\n        }\r\n    }\r\n\r\n    return (\r\n        <div className=\"mycard\">\r\n            <div className=\"card auth-card input-field\">\r\n                <h2>Instagram</h2>\r\n                <input\r\n                    type=\"text\"\r\n                    placeholder=\"Name\"\r\n                    value={name}\r\n                    onChange={(e) => setName(e.target.value)}  // Handle name input change\r\n                />\r\n                <input\r\n                    type=\"email\"\r\n                    placeholder=\"Email\"\r\n                    value={email}\r\n                    onChange={(e) => setEmail(e.target.value)}  // Handle email input change\r\n                />\r\n                <input\r\n                    type=\"password\"\r\n                    placeholder=\"Password\"\r\n                    value={password}\r\n                    onChange={(e) => setPassword(e.target.value)}  // Handle password input change\r\n                />\r\n                <div className=\"file-field input-field\">\r\n                    <div className=\"btn #64b5f6 blue darken-1\">\r\n                        <span>Upload pic</span>\r\n                        <input\r\n                            type=\"file\"\r\n                            onChange={(e) => setImage(e.target.files[0])}  // Set the image file\r\n                        />\r\n                    </div>\r\n                    <div className=\"file-path-wrapper\">\r\n                        <input className=\"file-path validate\" type=\"text\" />\r\n                    </div>\r\n                </div>\r\n                <button\r\n                    className=\"btn waves-effect waves-light #64b5f6 blue darken-1\"\r\n                    onClick={PostData}  // Trigger PostData on button click\r\n                >\r\n                    SignUp\r\n                </button>\r\n                <h5>\r\n                    <Link to=\"/signin\">Already have an account?</Link>\r\n                </h5>\r\n            </div>\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default SignIn\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}